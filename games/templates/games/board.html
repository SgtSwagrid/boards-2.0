{% load static %}
{% load mathfilters %}

<div class="board {% if not display.hexagonal %} z-depth-3 {% endif %}" style="
        width: {{ display.width }}px;
        height: {{ display.height }}px;">

    {% for row in display.rows %}

        <div style="
                position: absolute;
                width: {{ row.width }}px;
                height: {{ row.height }}px;
                top: {{ row.offset }}px;">

            {% for tile in row.tiles %}

                <div {% if event.active %}
                        onclick="clickBoard({{ tile.x }}, {{ tile.y }},
                            {{ event.properties.first_selection.0 }},
                            {{ event.properties.first_selection.1 }})"
                        {% endif %}>

                    {% if display.hexagonal %}
                        <div style="
                                position: absolute;
                                width: 0;
                                left: {{ tile.offset }}px;
                                top: -{{ row.height|div:2 }}px;
                                border-bottom: {{ row.height|div:2 }}px solid {{ tile.colour }};
                                border-left: {{ tile.width|div:2 }}px solid transparent;
                                border-right: {{ tile.width|div:2 }}px solid transparent;">
                        </div>
                    {% endif %}

                    <div style="
                            position: absolute;
                            width: {{ tile.width }}px;
                            height: {{ row.height }}px;
                            left: {{ tile.offset }}px;
                            background: {{ tile.colour }};">

                        {% for texture in tile.textures %}
                            <img src="{% static 'games/img/' %}{{ texture.image }}"} style="
                                position: absolute;
                                opacity: {{ texture.opacity }};
                                left: {{ texture.x }}%;
                                width: 100%;">
                        {% endfor %}

                    </div>

                    {% if display.hexagonal %}
                        <div style="
                                position: absolute;
                                width: 0;
                                left: {{ tile.offset }}px;
                                top: {{ row.height }}px;
                                border-top: {{ row.height|div:2 }}px solid {{ tile.colour }};
                                border-left: {{ tile.width|div:2 }}px solid transparent;
                                border-right: {{ tile.width|div:2 }}px solid transparent;">
                        </div>
                    {% endif %}

                </div>

            {% endfor %}

        </div>

    {% endfor %}

    {% if display.selector %}
        <div style="
                position: absolute;
                width: {{ display.selector.width }}px;
                height: {{ display.selector.height }}px;
                left: {{ display.selector.x }}px;
                top: {{ display.selector.y }}px;
                background: {{ display.selector.colour }};
                opacity: {{ display.selector.opacity }};
                z-index: 1000;
                border-radius: 15px;">

            {% for option in display.selector.options %}
                <div onclick="clickSelector({{ option.id }},
                            {{ display.selector.target_x }},
                            {{ display.selector.target_y }})" style="
                        position: absolute;
                        width: {{ display.selector.height }}px;
                        height: {{ display.selector.height }}px;
                        left: {{ display.selector.height|mul:option.id }}px;
                        background: {{ display.selector.colour }};
                        border-radius: 15px;
                        padding: 0px;">

                    {% for texture in option.textures %}
                        <img src="{% static 'games/img/' %}{{ texture.image }}"} style="
                                position: absolute;
                                opacity: {{ texture.opacity }};
                                left: {{ texture.x }}%;
                                width: 100%;">
                    {% endfor %}

                </div>
            {% endfor %}

        </div>
    {% endif %}

</div>